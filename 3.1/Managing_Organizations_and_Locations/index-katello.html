<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<title>Managing Organizations and Locations in Foreman</title>
<link rel="stylesheet" href="./katello.css">
<script>
const rl = document.location.toString();
if (rl.includes("/master/") || rl.includes("/nightly/") || rl.includes("file://")) {
  document.open();
  document.write("<span id=\"ribbon\"><a href=\"https://github.com/theforeman/foreman-documentation/tree/master/guides\">Nightly</a></span>");
  document.close();
}
</script>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Managing Organizations and Locations in Foreman</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#Introduction_to_Organization_and_Location_Context_managing-organizations-locations">1. Introduction to Organization and Location Context in Foreman</a></li>
<li><a href="#Managing_Organizations_managing-organizations-locations">2. Managing Organizations</a>
<ul class="sectlevel2">
<li><a href="#Creating_an_Organization_managing-organizations-locations">2.1. Creating an Organization</a></li>
<li><a href="#Setting_the_Organization_Context_managing-organizations-locations">2.2. Setting the Organization Context</a></li>
<li><a href="#Creating_an_Organization_Debug_Certificate_managing-organizations-locations">2.3. Creating an Organization Debug Certificate</a></li>
<li><a href="#Browsing_Repository_Content_Using_an_Organization_Debug_Certificate_managing-organizations-locations">2.4. Browsing Repository Content Using an Organization Debug Certificate</a></li>
<li><a href="#Deleting_an_Organization_managing-organizations-locations">2.5. Deleting an Organization</a></li>
</ul>
</li>
<li><a href="#Managing_Locations_managing-organizations-locations">3. Managing Locations</a>
<ul class="sectlevel2">
<li><a href="#Creating_a_Location_managing-organizations-locations">3.1. Creating a Location</a></li>
<li><a href="#Creating_Multiple_Locations_managing-organizations-locations">3.2. Creating Multiple Locations</a></li>
<li><a href="#Setting_the_Location_Context_managing-organizations-locations">3.3. Setting the Location Context</a></li>
<li><a href="#Deleting_a_Location_managing-organizations-locations">3.4. Deleting a Location</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="Introduction_to_Organization_and_Location_Context_managing-organizations-locations"><a class="anchor" href="#Introduction_to_Organization_and_Location_Context_managing-organizations-locations"></a>1. Introduction to Organization and Location Context in Foreman</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Context in Foreman consists of <a href="#Managing_Organizations_managing-organizations-locations">Organizations</a> and <a href="#Managing_Locations_managing-organizations-locations">Locations</a>.</p>
</div>
<div class="paragraph">
<p>Most resources in Foreman are associated with at least one organization and location context.
Since resources and users can generally only access resources within their own context, organizations and locations are an integral part of Foreman&#8217;s user management.</p>
</div>
<div class="paragraph">
<p>You can structure locations hierarchically by providing a parent location.
Unless otherwise specified, sub locations inherit the settings from their parent location.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you use host groups to bundle provisioning and configuration information, ensure to not mismatch resources from mutually exclusive contexts.
For example, setting a subnet from one organization or location and a compute resource from a different organization or location creates an invalid host group.</p>
</div>
<div class="paragraph">
<p>Some resources in Foreman, such as Ansible roles and operating systems, are not part of any organization or location context.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Managing_Organizations_managing-organizations-locations"><a class="anchor" href="#Managing_Organizations_managing-organizations-locations"></a>2. Managing Organizations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Organizations divide Foreman resources into logical groups based on ownership, purpose, content, security level, or other divisions.
You can create and manage multiple organizations through Foreman, then divide and assign subscriptions to each individual organization.
This provides a method of managing the content of several individual organizations under one management system.
Here are some examples of organization management:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Single Organization</dt>
<dd>
<p>A small business with a simple system administration chain.
In this case, you can create a single organization for the business and assign content to it.</p>
</dd>
<dt class="hdlist1">Multiple Organizations</dt>
<dd>
<p>A large company that owns several smaller business units.
For example, a company with separate system administration and software development groups.
In this case, you can create organizations for the company and each of the business units it owns.
This keeps the system infrastructure for each separate.
You can then assign content to each organization based on its needs.</p>
</dd>
<dt class="hdlist1">External Organizations</dt>
<dd>
<p>A company that manages external systems for other organizations.
For example, a company offering cloud computing and web hosting resources to customers.
In this case, you can create an organization for the company&#8217;s own system infrastructure and then an organization for each external business.
You can then assign content to each organization where necessary.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A default installation of Foreman has a default organization called <strong>Default_Organization</strong>.</p>
</div>
<div class="paragraph">
<div class="title">New Users</div>
<p>If a new user is not assigned a default organization, their access is limited.
To grant systems rights to users, assign them to a default organization.
The next time the user logs on to Foreman, the user&#8217;s account has the correct system rights.</p>
</div>
<div class="sect2">
<h3 id="Creating_an_Organization_managing-organizations-locations"><a class="anchor" href="#Creating_an_Organization_managing-organizations-locations"></a>2.1. Creating an Organization</h3>
<div class="paragraph">
<p>Use this procedure to create an organization.
To use the CLI instead of the Foreman web UI, see <a href="#cli-creating-an-organization">CLI procedure</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Organizations</strong>.</p>
</li>
<li>
<p>Click <strong>New Organization</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for the organization.</p>
</li>
<li>
<p>In the <strong>Label</strong> field, enter a unique identifier for the organization.
This is used for creating and mapping certain assets, such as directories for content storage.
Use letters, numbers, underscores, and dashes, but no spaces.</p>
</li>
<li>
<p>Optional: in the <strong>Description</strong> field, enter a description for the organization.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
<li>
<p>If you have hosts with no organization assigned, select the hosts that you want to add to the organization, then click <strong>Proceed to Edit</strong>.</p>
</li>
<li>
<p>In the <strong>Edit</strong> page, assign the infrastructure resources that you want to add to the organization.
This includes networking resources, installation media, kickstart templates, and other parameters.
You can return to this page at any time by navigating to <strong>Administer</strong> &gt; <strong>Organizations</strong> and then selecting an organization to edit.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
<div id="cli-creating-an-organization" class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>To create an organization, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre># hammer organization create \
--name "<em>My_Organization</em>" \
--label "<em>My_Organization_Label</em>" \
--description "<em>My_Organization_Description</em>"</pre>
</div>
</div>
</li>
<li>
<p>Optional: To edit an organization, enter the <code>hammer organization update</code> command.
For example, the following command assigns a compute resource to the organization:</p>
<div class="listingblock">
<div class="content">
<pre># hammer organization update \
--name "<em>My_Organization</em>" \
--compute-resource-ids 1</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Setting_the_Organization_Context_managing-organizations-locations"><a class="anchor" href="#Setting_the_Organization_Context_managing-organizations-locations"></a>2.2. Setting the Organization Context</h3>
<div class="paragraph">
<p>An organization context defines the organization to use for a host and its associated resources.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>The organization menu is the first menu item in the menu bar, on the upper left of the Foreman web UI.
If you have not selected a current organization, the menu says <strong>Any Organization</strong>.
Click the <strong>Any Organization</strong> button and select the organization to use.</p>
</div>
<div class="paragraph">
<div class="title">CLI procedure</div>
<p>While using the CLI, include either <code>--organization "<em>My_Organization</em>"</code> or <code>--organization-label "<em>My_Organization_Label</em>"</code> as an option.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># hammer subscription list \
--organization "<em>My_Organization</em>"</pre>
</div>
</div>
<div class="paragraph">
<p>This command outputs subscriptions allocated for the <em>My_Organization</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="Creating_an_Organization_Debug_Certificate_managing-organizations-locations"><a class="anchor" href="#Creating_an_Organization_Debug_Certificate_managing-organizations-locations"></a>2.3. Creating an Organization Debug Certificate</h3>
<div class="paragraph">
<p>If you require a debug certificate for your organization, use the following procedure.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Organizations</strong>.</p>
</li>
<li>
<p>Select an organization that you want to generate a debug certificate for.</p>
</li>
<li>
<p>Click <strong>Generate and Download</strong>.</p>
</li>
<li>
<p>Save the certificate file in a secure location.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Debug Certificates for Provisioning Templates</div>
<p>Debug Certificates are automatically generated for provisioning template downloads if they do not already exist in the organization for which they are being downloaded.</p>
</div>
</div>
<div class="sect2">
<h3 id="Browsing_Repository_Content_Using_an_Organization_Debug_Certificate_managing-organizations-locations"><a class="anchor" href="#Browsing_Repository_Content_Using_an_Organization_Debug_Certificate_managing-organizations-locations"></a>2.4. Browsing Repository Content Using an Organization Debug Certificate</h3>
<div class="paragraph">
<p>You can view an organization&#8217;s repository content using a web browser or using the API if you have a debug certificate for that organization.</p>
</div>
<div class="olist arabic">
<div class="title">Prerequisites</div>
<ol class="arabic">
<li>
<p>Create and download an organization certificate as described in <a href="https://docs.theforeman.org/3.1/Managing_Organizations_and_Locations/index-foreman-el.html#Creating_an_Organization_Debug_Certificate_managing-organizations-locations" class="bare">https://docs.theforeman.org/3.1/Managing_Organizations_and_Locations/index-foreman-el.html#Creating_an_Organization_Debug_Certificate_managing-organizations-locations</a>.</p>
</li>
<li>
<p>Open the X.509 certificate, for example, for the default organization:</p>
<div class="listingblock">
<div class="content">
<pre>$ vi 'Default Organization-key-cert.pem'</pre>
</div>
</div>
</li>
<li>
<p>Copy the contents of the file from <code>-----BEGIN RSA PRIVATE KEY-----</code> to <code>-----END RSA PRIVATE KEY-----</code>, into a <code>key.pem</code> file.</p>
</li>
<li>
<p>Copy the contents of the file from <code>-----BEGIN CERTIFICATE-----</code> to <code>-----END CERTIFICATE-----</code>, into a <code>cert.pem</code> file.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To use a browser, you must first convert the X.509 certificate to a format your browser supports and then import the certificate.</p>
</div>
<div class="paragraph">
<div class="title">For Firefox Users</div>
<p>To use an organization debug certificate in Firefox, complete the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To create a PKCS12 format certificate, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre>$ openssl pkcs12 -keypbe PBE-SHA1-3DES -certpbe PBE-SHA1-3DES -export -in cert.pem -inkey key.pem -out <em>organization_label</em>.pfx -name <em>My_Organization</em></pre>
</div>
</div>
</li>
<li>
<p>In the Firefox browser, navigate to <strong>Edit</strong> &gt; <strong>Preferences</strong> &gt; <strong>Advanced Tab</strong>.</p>
</li>
<li>
<p>Select <strong>View Certificates</strong>, and click the <strong>Your Certificates</strong> tab.</p>
</li>
<li>
<p>Click <strong>Import</strong> and select the <code>.pfx</code> file to load.</p>
</li>
<li>
<p>In the address bar, enter a URL in the following format to browse for repositories:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">http://<em>foreman.example.com</em>/pulp/repos/<em>organization_label</em></pre>
</div>
</div>
<div class="paragraph">
<p>Pulp uses the organization label, therefore, you must enter the organization label into the URL.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">For CURL Users</div>
<p>To use the organization debug certificate with CURL, enter the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -k --cert cert.pem --key key.pem \
http://<em>foreman.example.com</em>/pulp/repos/Default_Organization/Library/content/dist/rhel/server/7/7Server/x86_64/sat-tools/2.5/os/</pre>
</div>
</div>
<div class="paragraph">
<p>Ensure that the paths to <code>cert.pem</code> and <code>key.pem</code> are the correct absolute paths otherwise the command fails silently.</p>
</div>
</div>
<div class="sect2">
<h3 id="Deleting_an_Organization_managing-organizations-locations"><a class="anchor" href="#Deleting_an_Organization_managing-organizations-locations"></a>2.5. Deleting an Organization</h3>
<div class="paragraph">
<p>You can delete an organization if the organization is not associated with any life cycle environments or host groups.
If there are any life cycle environments or host groups associated with the organization you are about to delete, remove them by navigating to <strong>Administer</strong> &gt; <strong>Organizations</strong> and clicking the relevant organization.
Do not delete the default organization created during installation because the default organization is a placeholder for any unassociated hosts in the Foreman environment.
There must be at least one organization in the environment at any given time.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Organizations</strong>.</p>
</li>
<li>
<p>From the list to the right of the name of the organization you want to delete, select <strong>Delete</strong>.</p>
</li>
<li>
<p>Click <strong>OK</strong> to delete the organization.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>Enter the following command to retrieve the ID of the organization that you want to delete:</p>
<div class="listingblock">
<div class="content">
<pre># hammer organization list</pre>
</div>
</div>
<div class="paragraph">
<p>From the output, note the ID of the organization that you want to delete.</p>
</div>
</li>
<li>
<p>Enter the following command to delete an organization:</p>
<div class="listingblock">
<div class="content">
<pre># hammer organization delete --id <em>Organization_ID</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Managing_Locations_managing-organizations-locations"><a class="anchor" href="#Managing_Locations_managing-organizations-locations"></a>3. Managing Locations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Locations function similar to organizations: they provide a method to group resources and assign hosts.
Organizations and locations have the following conceptual differences:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Locations are based on physical or geographical settings.</p>
</li>
<li>
<p>Locations have a hierarchical structure.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="Creating_a_Location_managing-organizations-locations"><a class="anchor" href="#Creating_a_Location_managing-organizations-locations"></a>3.1. Creating a Location</h3>
<div class="paragraph">
<p>Use this procedure to create a location so that you can manage your hosts and resources by location.
To use the CLI instead of the Foreman web UI, see the <a href="#cli-creating-a-location">CLI procedure</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Administer &gt; Locations</strong>.</p>
</li>
<li>
<p>Click <strong>New Location</strong>.</p>
</li>
<li>
<p>Optional: from the <strong>Parent</strong> list, select a parent location.
This creates a location hierarchy.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for the location.</p>
</li>
<li>
<p>Optional: in the <strong>Description</strong> field, enter a description for the location.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
<li>
<p>If you have hosts with no location assigned, add any hosts that you want to assign to the new location, then click <strong>Proceed to Edit</strong>.</p>
</li>
<li>
<p>Assign any infrastructure resources that you want to add to the location.
This includes networking resources, installation media, kickstart templates, and other parameters.
You can return to this page at any time by navigating to <strong>Administer</strong> &gt; <strong>Locations</strong> and then selecting a location to edit.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save your changes.</p>
</li>
</ol>
</div>
<div id="cli-creating-a-location" class="ulist">
<div class="title">CLI procedure</div>
<ul>
<li>
<p>Enter the following command to create a location:</p>
<div class="listingblock">
<div class="content">
<pre># hammer location create \
--description "<em>My_Location_Description</em>" \
--name "<em>My_Location</em>" \
--parent-id "<em>My_Location_Parent_ID</em>"</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Creating_Multiple_Locations_managing-organizations-locations"><a class="anchor" href="#Creating_Multiple_Locations_managing-organizations-locations"></a>3.2. Creating Multiple Locations</h3>
<div class="paragraph">
<p>The following example Bash script creates three locations - London, Munich, Boston - and assigns them to the Example Organization.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-Bash" data-lang="Bash">ORG="<em>Example Organization</em>"
LOCATIONS="<em>London Munich Boston</em>"

for LOC in ${LOCATIONS}
do
  hammer location create --name "${LOC}"
  hammer location add-organization --name "${LOC}" --organization "${ORG}"
done</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Setting_the_Location_Context_managing-organizations-locations"><a class="anchor" href="#Setting_the_Location_Context_managing-organizations-locations"></a>3.3. Setting the Location Context</h3>
<div class="paragraph">
<p>A location context defines the location to use for a host and its associated resources.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>The location menu is the second menu item in the menu bar, on the upper left of the Foreman web UI.
If you have not selected a current location, the menu displays <strong>Any Location</strong>.
Click <strong>Any location</strong> and select the location to use.</p>
</div>
<div class="paragraph">
<div class="title">CLI procedure</div>
<p>While using the CLI, include either <code>--location "<em>My_Location</em>"</code> or <code>--location-id "<em>My_Location_ID</em>"</code> as an option.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># hammer subscription list \
--location "<em>My_Location</em>"</pre>
</div>
</div>
<div class="paragraph">
<p>This command outputs subscriptions allocated for the <em>My_Location</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="Deleting_a_Location_managing-organizations-locations"><a class="anchor" href="#Deleting_a_Location_managing-organizations-locations"></a>3.4. Deleting a Location</h3>
<div class="paragraph">
<p>You can delete a location if the location is not associated with any life cycle environments or host groups.
If there are any life cycle environments or host groups associated with the location you are about to delete, remove them by navigating to <strong>Administer</strong> &gt; <strong>Locations</strong> and clicking the relevant location.
Do not delete the default location created during installation because the default location is a placeholder for any unassociated hosts in the Foreman environment.
There must be at least one location in the environment at any given time.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Administer</strong> &gt; <strong>Locations</strong>.</p>
</li>
<li>
<p>Select <strong>Delete</strong> from the list to the right of the name of the location you want to delete.</p>
</li>
<li>
<p>Click <strong>OK</strong> to delete the location.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>Enter the following command to retrieve the ID of the location that you want to delete:</p>
<div class="listingblock">
<div class="content">
<pre># hammer location list</pre>
</div>
</div>
<div class="paragraph">
<p>From the output, note the ID of the location that you want to delete.</p>
</div>
</li>
<li>
<p>Enter the following command to delete the location:</p>
<div class="listingblock">
<div class="content">
<pre># hammer location delete --id <em>Location ID</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated Jan 2022
</div>
</div>
</body>
</html>