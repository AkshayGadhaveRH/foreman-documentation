<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Installing Capsule Server</title>
<link rel="stylesheet" href="./satellite.css">
<script>
const rl = document.location.toString();
if (rl.includes("/master/") || rl.includes("/nightly/") || rl.includes("file://")) {
  document.open();
  document.write("<span id=\"ribbon\"><a href=\"https://github.com/theforeman/foreman-documentation/tree/master/guides\">Nightly</a></span>");
  document.close();
}
</script>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Installing Capsule Server</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#preparing-environment-for-capsule-installation">1. Preparing your Environment for Installation</a>
<ul class="sectlevel2">
<li><a href="#system-requirements_capsule">1.1. System Requirements</a></li>
<li><a href="#capsule-storage-requirements_capsule">1.2. Storage Requirements</a></li>
<li><a href="#storage-guidelines_capsule">1.3. Storage Guidelines</a></li>
<li><a href="#supported-operating-systems_capsule">1.4. Supported Operating Systems</a></li>
<li><a href="#capsule-ports-and-firewalls-requirements_capsule">1.5. Ports and Firewalls Requirements</a></li>
<li><a href="#Enabling_Connections_from_Proxy_to_Server_capsule">1.6. Enabling Connections from Capsule&#160;Server to Satellite&#160;Server</a></li>
<li><a href="#enabling-connections-to-capsule_capsule">1.7. Enabling Connections from Satellite&#160;Server and Clients to a Capsule&#160;Server</a></li>
<li><a href="#verifying-firewall-settings_capsule">1.8. Verifying Firewall Settings</a></li>
</ul>
</li>
<li><a href="#installing-capsule-server">2. Installing Capsule&#160;Server</a>
<ul class="sectlevel2">
<li><a href="#Registering_Proxy_to_Server_capsule">2.1. Registering to Satellite&#160;Server</a></li>
<li><a href="#attaching-infrastructure-subscription_capsule">2.2. Attaching the Satellite Infrastructure Subscription</a></li>
<li><a href="#configuring-repositories_capsule">2.3. Configuring Repositories</a></li>
<li><a href="#Installing_Proxy_Packages_capsule">2.4. Installing Capsule&#160;Server Packages</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="preparing-environment-for-capsule-installation"><a class="anchor" href="#preparing-environment-for-capsule-installation"></a>1. Preparing your Environment for Installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="system-requirements_capsule"><a class="anchor" href="#system-requirements_capsule"></a>1.1. System Requirements</h3>
<div class="paragraph">
<p>The following requirements apply to the networked base operating system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>x86_64 architecture</p>
</li>
<li>
<p>The latest version of Red Hat Enterprise Linux 7 Server</p>
</li>
<li>
<p>4-core 2.0 GHz CPU at a minimum</p>
</li>
<li>
<p>A minimum of 12 GB RAM is required for Capsule&#160;Server to function.
In addition, a minimum of 4 GB RAM of swap space is also recommended.
Capsule running with less RAM than the minimum value might not operate correctly.</p>
</li>
<li>
<p>A unique host name, which can contain lower-case letters, numbers, dots (.) and hyphens (-)</p>
</li>
<li>
<p>A current Red&#160;Hat Satellite subscription</p>
</li>
<li>
<p>Administrative user (root) access</p>
</li>
<li>
<p>A system umask of 0022</p>
</li>
<li>
<p>Full forward and reverse DNS resolution using a fully-qualified domain name</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before you install Capsule&#160;Server, ensure that your environment meets the requirements for installation.</p>
</div>
<div class="paragraph">
<p>Capsule&#160;Server must be installed on a freshly provisioned system that serves no other function except to run Capsule&#160;Server.
The freshly provisioned system must not have the following users provided by external identity providers to avoid conflicts with the local users that Capsule&#160;Server creates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>apache</p>
</li>
<li>
<p>foreman</p>
</li>
<li>
<p>foreman-proxy</p>
</li>
<li>
<p>postgres</p>
</li>
<li>
<p>pulp</p>
</li>
<li>
<p>puppet</p>
</li>
<li>
<p>puppetserver</p>
</li>
<li>
<p>qdrouterd</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information on scaling your Capsule&#160;Servers, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.10/html-single/installing_capsule_server/index#capsule-server-scalability-considerations_capsule">Capsule&#160;Server Scalability Considerations</a>.</p>
</div>
<div class="paragraph">
<div class="title">Certified hypervisors</div>
<p>Capsule&#160;Server is fully supported on both physical systems and virtual machines that run on hypervisors that are supported to run Red&#160;Hat Enterprise Linux.
For more information about certified hypervisors, see <a href="https://access.redhat.com/certified-hypervisors">Which hypervisors are certified to run Red Hat Enterprise Linux?</a>.</p>
</div>
<div class="paragraph">
<div class="title">SELinux Mode</div>
<p>SELinux must be enabled, either in enforcing or permissive mode.
Installation with disabled SELinux is not supported.</p>
</div>
<div class="paragraph">
<div class="title">FIPS Mode</div>
<p>You can install Capsule&#160;Server on a Red&#160;Hat Enterprise Linux system that is operating in FIPS mode.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/chap-federal_standards_and_regulations#sec-Enabling-FIPS-Mode">Enabling FIPS Mode</a> in the <em>Red&#160;Hat Enterprise Linux Security Guide</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="capsule-storage-requirements_capsule"><a class="anchor" href="#capsule-storage-requirements_capsule"></a>1.2. Storage Requirements</h3>
<div class="paragraph">
<p>The following table details storage requirements for specific directories.
These values are based on expected use case scenarios and can vary according to individual environments.</p>
</div>
<div class="paragraph">
<p>The runtime size was measured with Red&#160;Hat Enterprise Linux 6, 7, and 8 repositories synchronized.</p>
</div>
<div class="sect3">
<h4 id="_red_hat_enterprise_linux_7"><a class="anchor" href="#_red_hat_enterprise_linux_7"></a>1.2.1. <a id="storage-rhel-7"></a>Red Hat Enterprise Linux 7</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Storage Requirements for Capsule&#160;Server Installation</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Directory</th>
<th class="tableblock halign-left valign-top">Installation Size</th>
<th class="tableblock halign-left valign-top">Runtime Size</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/var/lib/pulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">300 GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/var/opt/rh/rh-postgresql12/lib/pgsql</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/opt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not Applicable</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="storage-guidelines_capsule"><a class="anchor" href="#storage-guidelines_capsule"></a>1.3. Storage Guidelines</h3>
<div class="paragraph">
<p>Consider the following guidelines when installing Capsule&#160;Server to increase efficiency.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you mount the <code>/tmp</code> directory as a separate file system, you must use the <code>exec</code> mount option in the <code>/etc/fstab</code> file.
If <code>/tmp</code> is already mounted with the <code>noexec</code> option, you must change the option to <code>exec</code> and re-mount the file system.
This is a requirement for the <code>puppetserver</code> service to work.</p>
</li>
<li>
<p>Because most Capsule&#160;Server data is stored in the <code>/var</code> directory, mounting <code>/var</code> on LVM storage can help the system to scale.</p>
</li>
<li>
<p>The <code>/var/lib/qpidd/</code> directory uses slightly more than 2 MB per Content Host managed by the <code>goferd</code> service.
For example, 10 000 Content Hosts require 20 GB of disk space in <code>/var/lib/qpidd/</code>.</p>
</li>
<li>
<p>Use high-bandwidth, low-latency storage for the <code>/var/lib/pulp/</code> directories.
As Red&#160;Hat Satellite has many operations that are I/O intensive, using high latency, low-bandwidth storage causes performance degradation.
Ensure your installation has a speed in the range 60 - 80 Megabytes per second.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can use the <code>fio</code> tool to get this data.
See the Red&#160;Hat Knowledgebase solution <a href="https://access.redhat.com/solutions/3397771">Impact of Disk Speed on Satellite Operations</a> for more information on using the <code>fio</code> tool.</p>
</div>
<div class="ulist">
<div class="title">File System Guidelines</div>
<ul>
<li>
<p>Do not use the GFS2 file system as the input-output latency is too high.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Log File Storage</div>
<p>Log files are written to <code>/var/log/messages/,</code> <code>/var/log/httpd/</code>, and <code>/var/lib/foreman-proxy/openscap/content/</code>.
You can manage the size of these files using <strong>logrotate</strong>.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-viewing_and_managing_log_files#s2-log_rotation">Log Rotation</a> in the <em>Red Hat Enterprise Linux 7 System Administrator’s Guide</em>.</p>
</div>
<div class="paragraph">
<p>The exact amount of storage you require for log messages depends on your installation and setup.</p>
</div>
<div class="paragraph">
<div class="title">SELinux Considerations for NFS Mount</div>
<p>When the <code>/var/lib/pulp</code> directory is mounted using an NFS share, SELinux blocks the synchronization process.
To avoid this, specify the SELinux context of the <code>/var/lib/pulp</code> directory in the file system table by adding the following lines to <code>/etc/fstab</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>nfs.example.com:/nfsshare  /var/lib/pulp  nfs  context="system_u:object_r:var_lib_t:s0"  1 2</pre>
</div>
</div>
<div class="paragraph">
<p>If NFS share is already mounted, remount it using the above configuration and enter the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># restorecon -R /var/lib/pulp</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Duplicated Packages</div>
<p>Packages that are duplicated in different repositories are only stored once on the disk.
Additional repositories containing duplicate packages require less additional storage.
The bulk of storage resides in the <code>/var/lib/pulp/</code> directory.
These end points are not manually configurable.
Ensure that storage is available on the <code>/var</code> file system to prevent storage problems.</p>
</div>
<div class="paragraph">
<div class="title">Software Collections</div>
<p>Software collections are installed in the <code>/opt/rh/</code> and <code>/opt/theforeman/</code> directories.</p>
</div>
<div class="paragraph">
<p>Write and execute permissions by the root user are required for installation to the <code>/opt</code> directory.</p>
</div>
<div class="paragraph">
<div class="title">Symbolic links</div>
<p>You cannot use symbolic links for <code>/var/lib/pulp/</code>.</p>
</div>
<div class="paragraph">
<div class="title">Synchronized RHEL ISO</div>
<p>If you plan to synchronize RHEL content ISOs to Satellite, note that all minor versions of Red&#160;Hat Enterprise Linux also synchronize.
You must plan to have adequate storage on your Satellite to manage this.</p>
</div>
</div>
<div class="sect2">
<h3 id="supported-operating-systems_capsule"><a class="anchor" href="#supported-operating-systems_capsule"></a>1.4. Supported Operating Systems</h3>
<div class="paragraph">
<p>You can install the operating system from a disc, local ISO image, kickstart, or any other method that Red&#160;Hat supports.
Red&#160;Hat Capsule&#160;Server is supported only on the latest versions of Red&#160;Hat Enterprise Linux 7 Server that is available at the time when Capsule&#160;Server is installed.
Previous versions of Red&#160;Hat Enterprise Linux including EUS or z-stream are not supported.</p>
</div>
<div class="paragraph">
<p>The following operating systems are supported by the installer, have packages, and are tested for deploying Satellite:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Operating Systems supported by satellite-installer</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operating System</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Architecture</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Notes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Red&#160;Hat Enterprise Linux 7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x86_64 only</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Before you install Satellite, apply all operating system updates if possible.</p>
</div>
<div class="paragraph">
<p>Red&#160;Hat Capsule&#160;Server requires a Red&#160;Hat Enterprise Linux installation with the <code>@Base</code> package group with no other package-set modifications, and without third-party configurations or software not directly necessary for the direct operation of the server.
This restriction includes hardening and other non-Red&#160;Hat security software.
If you require such software in your infrastructure, install and verify a complete working Capsule&#160;Server first, then create a backup of the system before adding any non-Red&#160;Hat software.</p>
</div>
<div class="paragraph">
<p>Install Capsule&#160;Server on a freshly provisioned system.</p>
</div>
<div class="paragraph">
<p>Do not register Capsule&#160;Server to the Red&#160;Hat Content Delivery Network (CDN).</p>
</div>
<div class="paragraph">
<p>Red&#160;Hat does not support using the system for anything other than running Capsule&#160;Server.</p>
</div>
</div>
<div class="sect2">
<h3 id="capsule-ports-and-firewalls-requirements_capsule"><a class="anchor" href="#capsule-ports-and-firewalls-requirements_capsule"></a>1.5. Ports and Firewalls Requirements</h3>
<div class="paragraph">
<p>For the components of Satellite architecture to communicate, ensure that the required network ports are open and free on the base operating system.
You must also ensure that the required network ports are open on any network-based firewalls.</p>
</div>
<div class="paragraph">
<p>The installation of a Capsule&#160;Server fails if the ports between Satellite&#160;Server and Capsule&#160;Server are not open before installation starts.</p>
</div>
<div class="paragraph">
<p>Use this information to configure any network-based firewalls.
Note that some cloud solutions must be specifically configured to allow communications between machines because they isolate machines similarly to network-based firewalls.
If you use an application-based firewall, ensure that the application-based firewall permits all applications that are listed in the tables and known to your firewall.
If possible, disable the application checking and allow open port communication based on the protocol.</p>
</div>
<div class="paragraph">
<div class="title">Integrated Capsule</div>
<p>Satellite&#160;Server has an integrated Capsule and any host that is directly connected to Satellite&#160;Server is a Client of Satellite in the context of this section.
This includes the base operating system on which Capsule&#160;Server is running.</p>
</div>
<div class="paragraph">
<div class="title">Clients of Capsule</div>
<p>Hosts which are clients of Capsules, other than Satellite&#8217;s integrated Capsule, do not need access to Satellite&#160;Server.
For more information on Satellite Topology, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.10/html-single/planning_for_red_hat_satellite/index#sect-Documentation-Architecture_Guide-Capsule_Networking">Capsule Networking</a> in <em>Planning for Red&#160;Hat Satellite&#160;6</em>.</p>
</div>
<div class="paragraph">
<p>Required ports can change based on your configuration.</p>
</div>
<div class="paragraph">
<p>The following tables indicate the destination port and the direction of network traffic:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Capsule incoming traffic</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Destination Port</th>
<th class="tableblock halign-left valign-top">Protocol</th>
<th class="tableblock halign-left valign-top">Service</th>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Required For</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">53</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP and UDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS Servers and clients</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name resolution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">67</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DHCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dynamic IP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DHCP (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">69</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TFTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TFTP Server (optional)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">443, 80</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS, HTTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content Retrieval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">443, 80</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS, HTTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content Host Registration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capsule CA RPM installation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Red&#160;Hat Satellite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content Mirroring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Management</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Red&#160;Hat Satellite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capsule API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Smart Proxy functionality</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5647</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMQP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">goferd message bus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forward message to client (optional)</p>
<p class="tableblock">Katello agent to communicate with Qpid dispatcher</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisioning templates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Template retrieval for client installers, iPXE or UEFI HTTP Boot</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PXE Boot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Installation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8140</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Puppet agent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client updates (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content Host registration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initiation</p>
<p class="tableblock">Uploading facts</p>
<p class="tableblock">Sending installed packages and traces</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9090</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenSCAP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure Client</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9090</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Discovered Node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Discovery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Host discovery and provisioning</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9090</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Red&#160;Hat Satellite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capsule API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capsule functionality</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Any managed host that is directly connected to Satellite&#160;Server is a client in this context because it is a client of the integrated Capsule.
This includes the base operating system on which a Capsule&#160;Server is running.</p>
</div>
<div class="paragraph">
<p>A DHCP Capsule performs ICMP ping and TCP echo connection attempts to hosts in subnets with DHCP IPAM set to find out if an IP address considered for use is free.
This behavior can be turned off using <code>satellite-installer --foreman-proxy-dhcp-ping-free-ip=false</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Capsule outgoing traffic</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Destination Port</th>
<th class="tableblock halign-left valign-top">Protocol</th>
<th class="tableblock halign-left valign-top">Service</th>
<th class="tableblock halign-left valign-top">Destination</th>
<th class="tableblock halign-left valign-top">Required For</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ICMP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DHCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free IP checking (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">echo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DHCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free IP checking (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">22</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote execution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Run jobs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">53</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP and UDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS Servers on the Internet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS Server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resolve DNS records (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">53</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP and UDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS Server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capsule DNS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Validation of DNS conflicts (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">68</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DHCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dynamic IP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DHCP (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Satellite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capsule</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capsule</p>
<p class="tableblock">Configuration management</p>
<p class="tableblock">Template retrieval</p>
<p class="tableblock">OpenSCAP</p>
<p class="tableblock">Remote Execution result upload</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Red&#160;Hat Portal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SOS report</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assisting support cases (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Satellite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sync</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Satellite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client communication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forward requests from Client to Satellite</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Infoblox DHCP Server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DHCP management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When using Infoblox for DHCP, management of the DHCP leases (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">623</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Power management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BMC On/Off/Cycle/Status</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5646</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMQP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Satellite&#160;Server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Katello agent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forward message to Qpid dispatch router on Capsule (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7911</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DHCP, OMAPI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DHCP Server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DHCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The DHCP target is configured using <code>--foreman-proxy-dhcp-server</code> and defaults to localhost</p>
<p class="tableblock">ISC and <code>remote_isc</code> use a configurable port that defaults to 7911 and uses OMAPI</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Discovery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Capsule sends reboot command to the discovered host (optional)</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
ICMP to Port 7 UDP and TCP must not be rejected, but can be dropped.
The DHCP Capsule sends an ECHO REQUEST to the Client network to verify that an IP address is free.
Any response will prevent IP addresses being allocated.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="Enabling_Connections_from_Proxy_to_Server_capsule"><a class="anchor" href="#Enabling_Connections_from_Proxy_to_Server_capsule"></a>1.6. Enabling Connections from Capsule&#160;Server to Satellite&#160;Server</h3>
<div class="paragraph">
<p>On Satellite&#160;Server, you must enable the incoming connection from Capsule&#160;Server to Satellite&#160;Server and make this rule persistent across reboots.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ensure that the firewall rules on Satellite&#160;Server are configured to enable connections for client to Satellite communication, because Capsule&#160;Server is a client of Satellite&#160;Server.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.10/html-single/installing_satellite_server_from_a_connected_network/index#Enabling_Connections_from_a_Client_to_Server_satellite">Enabling Connections from a Client to Satellite&#160;Server</a> in <em>Installing Satellite Server from a Connected Network</em>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On Satellite&#160;Server, enter the following command to open the port for Capsule to Satellite communication:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># firewall-cmd --add-port="5646/tcp"</pre>
</div>
</div>
</li>
<li>
<p>Make the changes persistent:</p>
<div class="listingblock">
<div class="content">
<pre># firewall-cmd --runtime-to-permanent</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="enabling-connections-to-capsule_capsule"><a class="anchor" href="#enabling-connections-to-capsule_capsule"></a>1.7. Enabling Connections from Satellite&#160;Server and Clients to a Capsule&#160;Server</h3>
<div class="paragraph">
<p>On the base operating system on which you want to install Capsule, you must enable incoming connections from Satellite&#160;Server and clients to Capsule&#160;Server and make these rules persistent across reboots.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On the base operating system on which you want to install Capsule, enter the following command to open the ports for Satellite&#160;Server and clients communication to Capsule&#160;Server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># firewall-cmd \
--add-port="53/udp" --add-port="53/tcp" \
--add-port="67/udp" \
--add-port="69/udp" \
--add-port="80/tcp" --add-port="443/tcp" \
--add-port="5647/tcp" \
--add-port="8140/tcp" \
--add-port="8443/tcp" \
--add-port="8000/tcp" --add-port="9090/tcp"</pre>
</div>
</div>
</li>
<li>
<p>Make the changes persistent:</p>
<div class="listingblock">
<div class="content">
<pre># firewall-cmd --runtime-to-permanent</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="verifying-firewall-settings_capsule"><a class="anchor" href="#verifying-firewall-settings_capsule"></a>1.8. Verifying Firewall Settings</h3>
<div class="paragraph">
<p>Use this procedure to verify your changes to the firewall settings.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># firewall-cmd --list-all</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/sec-using_firewalls#sec-Getting_started_with_firewalld">Getting Started with firewalld</a> in the <em>Red Hat Enterprise Linux 7 Security Guide</em>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installing-capsule-server"><a class="anchor" href="#installing-capsule-server"></a>2. Installing Capsule&#160;Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you install Capsule&#160;Server, you must ensure that your environment meets the requirements for installation.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.10/html-single/installing_capsule_server/index#preparing-environment-for-capsule-installation">Preparing your Environment for Installation</a>.</p>
</div>
<div class="sect2">
<h3 id="Registering_Proxy_to_Server_capsule"><a class="anchor" href="#Registering_Proxy_to_Server_capsule"></a>2.1. Registering to Satellite&#160;Server</h3>
<div class="paragraph">
<p>Use this procedure to register the base operating system on which you want to install Capsule&#160;Server to Satellite&#160;Server.</p>
</div>
<div class="ulist">
<div class="title">Red&#160;Hat Subscription Manifest Prerequisites</div>
<ul>
<li>
<p>On Satellite&#160;Server, a manifest must be installed and it must contain the appropriate repositories for the organization you want Capsule to belong to.</p>
</li>
<li>
<p>The manifest must contain repositories for the base operating system on which you want to install Capsule, as well as any clients that you want to connect to Capsule.</p>
</li>
<li>
<p>The repositories must be synchronized.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information on manifests and repositories, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.10/html-single/content_management_guide/index#Managing_Red_Hat_Subscriptions_content-management">Managing Red Hat Subscriptions</a> in the <em>Red&#160;Hat Satellite Content Management Guide</em>.</p>
</div>
<div class="ulist">
<div class="title">Proxy and Network Prerequisites</div>
<ul>
<li>
<p>The Satellite&#160;Server base operating system must be able to resolve the host name of the Capsule base operating system and vice versa.</p>
</li>
<li>
<p>The base operating system on which you want to install Capsule&#160;Server must not be configured to use a proxy to connect to the Red Hat CDN.</p>
</li>
<li>
<p>You must configure the host and network-based firewalls accordingly.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.10/html-single/installing_capsule_server/index#capsule-ports-and-firewalls-requirements_capsule">Ports and Firewalls Requirements</a>.
:leveloffset: +1</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can register hosts with Satellite using the host registration feature, the Satellite API, or Hammer CLI.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Foreman web UI, navigate to <strong>Hosts &gt; Register Host</strong>.</p>
</li>
<li>
<p>Click <strong>Generate</strong> to create the registration command.</p>
</li>
<li>
<p>Click on the <em>files</em> icon to copy the command to your clipboard.</p>
</li>
<li>
<p>Log on to the host you want register and run the previously generated command.</p>
</li>
<li>
<p>Check the <code>/etc/yum.repos.d/redhat.conf</code> and ensure that the appropriate repositories have been enabled.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>Generate the host registration command using the Hammer CLI:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># hammer host-registration generate-command \
--activation-keys "<em>My_Activation_Key</em>"</pre>
</div>
</div>
</li>
<li>
<p>Log on to the host you want register and run the previously generated command.</p>
</li>
<li>
<p>Check the <code>/etc/yum.repos.d/redhat.conf</code> and ensure that the appropriate repositories have been enabled.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">API procedure</div>
<ol class="arabic">
<li>
<p>Generate the host registration command using the Satellite API:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># curl -X POST https://satellite.example.com/api/registration_commands \
--user "<em>My_User_Name</em>" \
-H 'Content-Type: application/json' \
-d '{ "registration_command": { "activation_keys": ["<em>My_Activation_Key_1</em>, <em>My_Activation_Key_2</em>"] }}'</pre>
</div>
</div>
<div class="paragraph">
<p>Use an activation key to simplify specifying the environments.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.10/html-single/content_management_guide/index#Managing_Activation_Keys_content-management">Managing Activation Keys</a> in the <em>Content Management</em> guide.</p>
</div>
<div class="paragraph">
<p>To enter a password as command line argument, use <code>username:password</code> syntax.
Keep in mind this can save the password in the shell history.</p>
</div>
<div class="paragraph">
<p>For more information about registration see <a href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.10/html-single/managing_hosts/index#registering-a-host_managing-hosts">Registering a Host to Red&#160;Hat Satellite</a>.</p>
</div>
</li>
<li>
<p>Log on to the host you want register and run the previously generated command.</p>
</li>
<li>
<p>Check the <code>/etc/yum.repos.d/redhat.conf</code> and ensure that the appropriate repositories have been enabled.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="attaching-infrastructure-subscription_capsule"><a class="anchor" href="#attaching-infrastructure-subscription_capsule"></a>2.2. Attaching the Satellite Infrastructure Subscription</h3>
<div class="paragraph">
<p>After you have registered Capsule&#160;Server, you must identify your subscription Pool ID and attach an available subscription.
The Red&#160;Hat Satellite Infrastructure subscription provides access to the Red&#160;Hat Satellite, Red&#160;Hat Enterprise Linux, and Red&#160;Hat Software Collections (RHSCL) content.
This is the only subscription required.</p>
</div>
<div class="paragraph">
<p>Red&#160;Hat Satellite Infrastructure is included with all subscriptions that include Smart Management.
For more information, see the Red&#160;Hat Knowledgebase solution <a href="https://access.redhat.com/solutions/3382781">Satellite Infrastructure Subscriptions MCT3718 MCT3719</a>.</p>
</div>
<div class="paragraph">
<p>Subscriptions are classified as available if they are not already attached to a system.
If you are unable to find an available Satellite subscription, see the Red&#160;Hat Knowledgebase solution <a href="https://access.redhat.com/solutions/2058823">How do I figure out which subscriptions have been consumed by clients registered under Red Hat Subscription Manager?</a> to run a script to see if your subscription is being consumed by another system.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Identify the Pool ID of the Satellite Infrastructure subscription:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager list --all --available --matches 'Red Hat Satellite Infrastructure Subscription'</pre>
</div>
</div>
<div class="paragraph">
<p>The command displays output similar to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Subscription Name:   Red Hat Satellite Infrastructure Subscription
Provides:            Red Hat Satellite
                      Red Hat Software Collections (for RHEL Server)
                      Red Hat CodeReady Linux Builder for x86_64
                      Red Hat Ansible Engine
                      Red Hat Enterprise Linux Load Balancer (for RHEL Server)
                      Red Hat
                      Red Hat Software Collections (for RHEL Server)
                      Red Hat Enterprise Linux Server
                      Red Hat Satellite Capsule
                      Red Hat Enterprise Linux for x86_64
                      Red Hat Enterprise Linux High Availability for x86_64
                      Red Hat Satellite
                      Red Hat Satellite 5 Managed DB
                      Red Hat Satellite 6
                      Red Hat Discovery
SKU:                 MCT3719
Contract:            11878983
Pool ID:             8a85f99968b92c3701694ee998cf03b8
Provides Management: No
Available:           1
Suggested:           1
Service Level:       Premium
Service Type:        L1-L3
Subscription Type:   Standard
Ends:                03/04/2020
System Type:         Physical</pre>
</div>
</div>
</li>
<li>
<p>Make a note of the subscription Pool ID.
Your subscription Pool ID is different from the example provided.</p>
</li>
<li>
<p>Attach the Satellite Infrastructure subscription to the base operating system that your Capsule&#160;Server is running on:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager attach --pool=<em>pool_id</em></pre>
</div>
</div>
<div class="paragraph">
<p>The command displays output similar to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Successfully attached a subscription for: Red Hat Satellite Infrastructure Subscription</pre>
</div>
</div>
</li>
<li>
<p>Optional: Verify that the Satellite Infrastructure subscription is attached:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager list --consumed</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="configuring-repositories_capsule"><a class="anchor" href="#configuring-repositories_capsule"></a>2.3. Configuring Repositories</h3>
<div class="paragraph">
<p>Use this procedure to enable the repositories that are required to install Capsule&#160;Server. Choose from the available list which operating system and version you are installing on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#repositories-rhel-7">Red Hat Enterprise Linux 7</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_red_hat_enterprise_linux_7_2"><a class="anchor" href="#_red_hat_enterprise_linux_7_2"></a>2.3.1. <a id="repositories-rhel-7"></a>Red Hat Enterprise Linux 7</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Disable all repositories:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos --disable "*"</pre>
</div>
</div>
</li>
<li>
<p>Enable the following repositories:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos --enable=rhel-7-server-rpms \
--enable=rhel-7-server-satellite-6.10-rpms \
--enable=rhel-7-server-satellite-maintenance-6-rpms \
--enable=rhel-server-rhscl-7-rpms \
--enable=rhel-7-server-ansible-2.9-rpms</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are installing Capsule&#160;Server as a virtual machine hosted on Red&#160;Hat&#160;Virtualization, you must also enable the <strong>Red&#160;Hat Common</strong> repository, and install Red&#160;Hat&#160;Virtualization guest agents and drivers.
For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.3/html/virtual_machine_management_guide/installing_guest_agents_and_drivers_linux#Installing_the_Guest_Agents_and_Drivers_on_Red_Hat_Enterprise_Linux">Installing the Guest Agents and Drivers on Red Hat Enterprise Linux</a> in the <em>Virtual Machine Management Guide</em>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Installing_Proxy_Packages_capsule"><a class="anchor" href="#Installing_Proxy_Packages_capsule"></a>2.4. Installing Capsule&#160;Server Packages</h3>
<div class="paragraph">
<p>Before installing Capsule&#160;Server packages, you must update all packages that are installed on the base operating system.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#rhel-7-package">Red Hat Enterprise Linux 7</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To install Capsule&#160;Server, complete the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Update all packages:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum update</pre>
</div>
</div>
</li>
<li>
<p>Install the <code>satellite-capsule</code> package:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum install satellite-capsule</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated Jan 2022
</div>
</div>
</body>
</html>